var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{e as s,ac as n,H as u,ad as d,ae as p,f as c,u as m,r as f,h as g,l as y,o as v,j as h,k as b,m as _,a9 as S,n as P}from"./vendor.1cb7f2f0.js";import{a as w}from"./globalTypes.4ad4b672.js";import{a as O,d as U,v as x,i as L,H as j}from"./index.f7adef75.js";var k=s({name:"PageHost",components:{BankOutlined:n,HomeOutlined:u,PlusOutlined:d,LoadingOutlined:p},setup(){const e=c(!1),s=c("");const{mutate:n,onDone:u,onError:d,loading:p}=m(j),y=g();u((e=>{O("You've successfully created your listing!"),y.push(`/listing/${e.data.hostListing.id}`)})),d((()=>{U("Sorry! We were'nt able to create your listing. Please try again later.")}));return{formState:f({type:"",numOfGuests:1,title:"",description:"",address:"",city:"",state:"",zip:"",image:[],price:""}),rules:{type:[{required:!0,message:"Please select a home type!",trigger:"change"}],numOfGuests:[{required:!0,message:"Please enter the max number of guests!",type:"number"}],title:[{required:!0,message:"Please enter a title for your listing!"}],description:[{required:!0,message:"Please enter a description for your listing!"}],address:[{required:!0,message:"Please enter an address for your listing!"}],city:[{required:!0,message:"Please enter a city (or region) for your listing!"}],state:[{required:!0,message:"Please enter a state (or province) for your listing!"}],zip:[{required:!0,message:"Please enter a zip (or postal) code for your listing!"}],image:[{required:!0,message:"Please provide an image for your listing!",type:"array",trigger:"['change', 'blur']"}],price:[{required:!0,message:"Please enter a price for your listing!",type:"number"}]},finish:function(e){console.log("finish",e,s.value);const u=`${e.address}, ${e.city}, ${e.state}, ${e.zip}`,d=(p=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&i(e,t,a[t]);return e})({},e),c={address:u,image:s.value,price:100*e.price},a(p,t(c)));var p,c;delete d.city,delete d.state,delete d.zip,n({input:d})},ListingType:w,viewer:x,iconColor:L,loading:p,imageLoading:e,imageBase64Value:s,handleImageUpload:function(a){"uploading"!==a.file.status?("done"===a.file.status&&function(e,a){const t=new FileReader;t.addEventListener("load",(()=>a(t.result))),t.readAsDataURL(e)}(a.file.originFileObj,(a=>{s.value=a,e.value=!1})),"error"===a.file.status&&(s.value=!1,U("upload error"))):e.value=!0},beforeImageUpload:e=>{const a="image/jpeg"===e.type||"image/png"===e.type;a||U("You can only upload JPG file!");const t=e.size/1024/1024<2;return t||U("Image must smaller than 2MB!"),a&&t}}}});const z={key:0,class:"host__form-header"},A=P(" You'll have to be signed in and connected with Stripe to host a listing! "),q=P(" We only allow users who've signed in to our application and have connected with Stripe to host new listings. You can sign in at the "),B=P(" login "),T=P(" page and connect with Stripe shortly after. "),G={key:1,class:"host__form-header"},H=P(" Please wait! "),I=P(" We're creating your listing now. "),C={class:"host__form-header"},M=P(" Hi! Let's get started listing your place. "),$=P(" In this form, we'll collect some basic and additional information about your listing. "),D=_("span",null," Apartment",-1),E=_("span",null," House",-1),F={class:"host__form-image-upload"},W={key:1},Y=_("div",{class:"ant-upload-text"}," Upload ",-1),N=P(" Submit ");k.render=function(e,a,t,l,o,r){const i=y("a-typography-title"),s=y("router-link"),n=y("a-typography-text"),u=y("BankOutlined"),d=y("a-radio-button"),p=y("HomeOutlined"),c=y("a-radio-group"),m=y("a-form-item"),f=y("a-input-number"),g=y("a-input"),P=y("a-textarea"),w=y("LoadingOutlined"),O=y("PlusOutlined"),U=y("a-upload"),x=y("a-button"),L=y("a-form"),j=y("a-layout-content");return v(),h(j,{class:"host-content"},{default:b((()=>[e.viewer.hasWallet?S("",!0):(v(),h("div",z,[_(i,{level:3,class:"host__form-title"},{default:b((()=>[A])),_:1}),_(n,{type:"secondary"},{default:b((()=>[q,_(s,{to:"/login"},{default:b((()=>[B])),_:1}),T])),_:1})])),e.loading?(v(),h("div",G,[_(i,{level:3,class:"host__form-title"},{default:b((()=>[H])),_:1}),_(n,{type:"secondary"},{default:b((()=>[I])),_:1})])):S("",!0),e.viewer.hasWallet?(v(),h(L,{key:2,rules:e.rules,layout:"vertical",model:e.formState,onFinish:e.finish},{default:b((()=>[_("div",C,[_(i,{level:3,class:"host__form-title"},{default:b((()=>[M])),_:1}),_(n,{type:"secondary"},{default:b((()=>[$])),_:1})]),_(m,{label:"Home Type",name:"type"},{default:b((()=>[_(c,{value:e.formState.type,"onUpdate:value":a[1]||(a[1]=a=>e.formState.type=a)},{default:b((()=>[_(d,{value:e.ListingType.APARTMENT},{default:b((()=>[_(u,{style:{color:e.iconColor}},null,8,["style"]),D])),_:1},8,["value"]),_(d,{value:e.ListingType.HOUSE},{default:b((()=>[_(p,{style:{color:e.iconColor}},null,8,["style"]),E])),_:1},8,["value"])])),_:1},8,["value"])])),_:1}),_(m,{label:"Max # of Guests",name:"numOfGuests"},{default:b((()=>[_(f,{value:e.formState.numOfGuests,"onUpdate:value":a[2]||(a[2]=a=>e.formState.numOfGuests=a),min:1,placeholder:"4"},null,8,["value"])])),_:1}),_(m,{name:"title",label:"Title",extra:"Max character count of 45"},{default:b((()=>[_(g,{value:e.formState.title,"onUpdate:value":a[3]||(a[3]=a=>e.formState.title=a),"max-length":45,placeholder:"The iconic and luxurious Bel-Air mansion"},null,8,["value"])])),_:1}),_(m,{label:"Description",extra:"Max character count of 400",name:"description"},{default:b((()=>[_(P,{value:e.formState.description,"onUpdate:value":a[4]||(a[4]=a=>e.formState.description=a),rows:3,"max-length":400,placeholder:"Modern, clean and iconic home of the Fresh Prince. Situated in the heart of Bel-Air, Los Angeles."},null,8,["value"])])),_:1}),_(m,{name:"address",label:"Address"},{default:b((()=>[_(g,{value:e.formState.address,"onUpdate:value":a[5]||(a[5]=a=>e.formState.address=a),placeholder:"251 North Bristol Avenue","auto-complete":"street-address"},null,8,["value"])])),_:1}),_(m,{name:"city",label:"City/Town"},{default:b((()=>[_(g,{value:e.formState.city,"onUpdate:value":a[6]||(a[6]=a=>e.formState.city=a),placeholder:"Los Angeles","auto-complete":"address-level2"},null,8,["value"])])),_:1}),_(m,{name:"state",label:"State/Province"},{default:b((()=>[_(g,{value:e.formState.state,"onUpdate:value":a[7]||(a[7]=a=>e.formState.state=a),placeholder:"California","auto-complete":"address-level1"},null,8,["value"])])),_:1}),_(m,{name:"zip",label:"Zip/Postal Code"},{default:b((()=>[_(g,{value:e.formState.zip,"onUpdate:value":a[8]||(a[8]=a=>e.formState.zip=a),placeholder:"Please enter a zip code for your listing!","auto-complete":"postal-code"},null,8,["value"])])),_:1}),_(m,{name:"image",label:"Image",extra:"Images have to be under 2MB in size and of type JPG or PNG"},{default:b((()=>[_("div",F,[_(U,{"file-list":e.formState.image,"onUpdate:file-list":a[9]||(a[9]=a=>e.formState.image=a),name:"image","list-type":"picture-card","show-upload-list":!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76","before-upload":e.beforeImageUpload,onChange:e.handleImageUpload},{default:b((()=>[e.imageBase64Value?(v(),h("img",{key:0,src:e.imageBase64Value,alt:"listing"},null,8,["src"])):(v(),h("div",W,[e.imageLoading?(v(),h(w,{key:0})):(v(),h(O,{key:1})),Y]))])),_:1},8,["file-list","before-upload","onChange"])])])),_:1}),_(m,{name:"price",label:"Price",extra:"All prices in $USD/day"},{default:b((()=>[_(f,{value:e.formState.price,"onUpdate:value":a[10]||(a[10]=a=>e.formState.price=a),min:0,placeholder:"120"},null,8,["value"])])),_:1}),_(m,null,{default:b((()=>[_(x,{type:"primary","html-type":"submit"},{default:b((()=>[N])),_:1})])),_:1})])),_:1},8,["rules","model","onFinish"])):S("",!0)])),_:1})};export default k;
