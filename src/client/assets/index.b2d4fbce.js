var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;import{d as o,a6 as l,u,k as g,o as c,i as d,l as p,j as f,m,a1 as h,F as y,aa as _,r as k,a2 as b,a3 as v,ac as P,h as w}from"./vendor.f6cb48f4.js";import{s as S,D as U,v as L,U as j}from"./index.da3c834b.js";import{a as O,d as C,f as B}from"./index.c2480ec4.js";import{_ as x}from"./ListingCard.fe5ed947.js";var I=o({name:"UserProfile",props:{user:Object,viewer:Object,viewerIsUser:Boolean},setup(e){const t=l((()=>e.user.income?B(e.user.income):"0$")),{mutate:s,loading:i,onDone:r,onError:a}=u(U);return r((e=>{S({hasWallet:e.data.disconnectStripe.hasWallet}),O("You've successfully disconnected from Stripe!","You'll have to reconnect with Stripe to continue to create listings.")})),a((()=>{C("Sorry! We were'nt able to disconnect you from Stripe. Please try again later!")})),{redirectToStripe:function(){window.location.href="https://connect.stripe.com/oauth/authorize?response_type=code&client_id=ca_Jct01FqHbwFDuTozLhgtHUByBtu7MK6r&scope=read_write"},disconnectStripe:function(){s()},income:t,loading:i}}});const T={class:"user-profile"},D={class:"user-profile__avatar"},E={class:"user-profile__details"},z=m(" Details "),N=m(" Name: "),W=m(" Contact: "),H={class:"user-profile__details"},F=m(" Additional Details "),R=m(" Stripe Registered "),Y=m(" Icome Earned:Â  "),q=m(" Disconnect Stripe "),A=m(" By disconnecting, you won't be able to recieve "),J=m(" any further payments "),K=m(". This will prevent users from booking listings that you might have already created. "),M=m(" Interested in becoming a TinyHouse host? Register with your Stripe account! "),$=m(" Connect with Stripe "),G=m(" TinyHouse uses "),Q=p("a",{href:"https://stripe.com/en-US/connect",target:"_blank",rel:"noopener noreferrer"}," Stripe ",-1),V=m(" to help transfer your earnings in a secure and trusted manner. ");I.render=function(e,t,s,i,r,a){const n=g("a-avatar"),o=g("a-divider"),l=g("a-typography-title"),u=g("a-typography-text"),k=g("a-typography-paragraph"),b=g("a-tag"),v=g("a-button"),P=g("a-card");return c(),d("div",T,[p(P,{class:"user-profile__card"},{default:f((()=>[p("div",D,[p(n,{src:e.user.avatar,size:100},null,8,["src"])]),p(o),p("div",E,[p(l,{level:4},{default:f((()=>[z])),_:1}),p(k,null,{default:f((()=>[N,p(u,{strong:""},{default:f((()=>[m(h(e.user.name),1)])),_:1}),p(k,null,{default:f((()=>[W,p(u,{strong:""},{default:f((()=>[m(h(e.user.contact),1)])),_:1})])),_:1})])),_:1})]),e.viewerIsUser?(c(),d(y,{key:0},[p(o),p("div",H,[p(l,{level:4},{default:f((()=>[F])),_:1}),e.viewer.hasWallet?(c(),d(y,{key:0},[p(k,null,{default:f((()=>[p(b,{color:"green"},{default:f((()=>[R])),_:1})])),_:1}),p(k,null,{default:f((()=>[Y,p(u,{strong:""},{default:f((()=>[m(h(e.income),1)])),_:1})])),_:1}),p(v,{type:"danger",class:"user-profile__details-cta",loading:e.loading,onClick:e.disconnectStripe},{default:f((()=>[q])),_:1},8,["loading","onClick"]),p(k,{type:"secondary"},{default:f((()=>[A,p(u,{strong:""},{default:f((()=>[J])),_:1}),K])),_:1})],64)):(c(),d(y,{key:1},[p(k,null,{default:f((()=>[M])),_:1}),p(v,{type:"primary",class:"user-profile__details-cta",onClick:e.redirectToStripe},{default:f((()=>[$])),_:1},8,["onClick"]),p(k,{type:"secondary"},{default:f((()=>[G,Q,V])),_:1})],64))])],64)):_("",!0)])),_:1})])};var X=o({name:"UserListing",components:{ListingCard:x},props:{userListings:Object,listingsPage:Number,limit:Number},emits:["update:listingsPage"],setup:(e,{emit:t})=>({setListingsPage:function(e){t("update:listingsPage",e)}})});const Z={class:"user-listings"},ee=m(" Listings "),te=m(" This section highlights the listings this user currently hosts and has made available for bookings. ");X.render=function(e,t,s,i,r,a){const n=g("a-typography-title"),o=g("a-typography-paragraph"),l=g("ListingCard"),u=g("a-list-item"),m=g("a-list");return c(),d("div",Z,[p(n,{level:4,class:"user-listings__title"},{default:f((()=>[ee])),_:1}),p(o,{class:"user-listings__description"},{default:f((()=>[te])),_:1}),p(m,{grid:{gutter:8,xs:1,sm:2,lg:4},dataSource:e.userListings.result,locale:{emptyText:"User doesn't have any listings yet!"},pagination:{position:"top",current:e.listingsPage,total:e.userListings.total,defaultPageSize:e.limit,hideOnSinglePage:!0,showLessItems:!0,onChange:e.setListingsPage}},{renderItem:f((({item:e})=>[p(u,null,{default:f((()=>[p(l,{listing:e},null,8,["listing"])])),_:2},1024)])),_:1},8,["dataSource","pagination"])])};var se=o({name:"UserBookings",components:{ListingCard:x},props:{userBookings:Object,bookingsPage:Number,limit:Number},emits:["update:bookingsPage"],setup:(e,{emit:t})=>({setBookingsPage:function(e){t("update:bookingsPage",e)}})});const ie={class:"user-bookings"},re=m(" Bookings "),ae=m(" This section highlights the bookings you've made, and the check-in/check-out dates associated with the said bookings. "),ne={class:"user-bookings__bookings-history"},oe=m(" Check in: "),le=m(" Check out: ");se.render=function(e,t,s,i,r,a){const n=g("a-typography-title"),o=g("a-typography-paragraph"),l=g("a-typography-text"),u=g("ListingCard"),y=g("a-list-item"),_=g("a-list");return c(),d("div",ie,[p(n,{level:4,class:"user-bookings__title"},{default:f((()=>[re])),_:1}),p(o,{class:"user-bookings__description"},{default:f((()=>[ae])),_:1}),p(_,{grid:{gutter:8,xs:1,sm:2,lg:4},"data-source":e.userBookings.result,locale:{emptyText:"You haven't made any bookings!"},pagination:{position:"top",current:e.bookingsPage,total:e.userBookings.total,defaultPageSize:e.limit,hideOnSinglePage:!0,showLessItems:!0,onChange:e.setBookingsPage}},{renderItem:f((({item:e})=>[p(y,null,{default:f((()=>[p("div",ne,[p("div",null,[oe,p(l,{strong:""},{default:f((()=>[m(h(e.checkIn),1)])),_:2},1024)]),p("div",null,[le,p(l,{strong:""},{default:f((()=>[m(h(e.checkOut),1)])),_:2},1024)])]),p(u,{listing:e.listing},null,8,["listing"])])),_:2},1024)])),_:1},8,["data-source","pagination"])])};var ue=o({name:"PageUser",components:{UserProfile:I,UserListings:X,UserBookings:se},setup(){const e=w(),o=k({id:e.params.id,bookingsPage:1,listingsPage:1,limit:4}),{result:u,loading:g,error:c}=b(j,o,{fetchPolicy:"cache-and-network"}),d=v(u,null,(e=>e.user)),p=l((()=>L.id===e.params.id)),f=new URL(window.location.href).searchParams.get("stripe_error");return m=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&n(e,s,t[s]);if(i)for(var s of i(t))a.call(t,s)&&n(e,s,t[s]);return e})({user:d,loading:g,error:c,viewer:L,viewerIsUser:p},P(o)),t(m,s({stripeError:f}));var m}});ue.render=function(e,t,s,i,r,a){const n=g("ErrorBanner"),o=g("PageSkeleton"),l=g("UserProfile"),u=g("a-col"),m=g("UserListings"),h=g("UserBookings"),k=g("a-row"),b=g("a-layout-content");return c(),d(b,{class:"user"},{default:f((()=>[e.stripeError?(c(),d(n,{key:0,description:"We had an issue connecting with Stripe. Please try again soon."})):_("",!0),e.loading&&!e.user?(c(),d(o,{key:1})):e.error?(c(),d(y,{key:2},[p(n,{description:"This user may not exist or we 've encountered an error. Please try again soon"}),p(o)],64)):(c(),d(k,{key:3,gutter:12,type:"flex",justify:"space-between"},{default:f((()=>[p(u,{xs:24},{default:f((()=>[p(l,{user:e.user,viewer:e.viewer,"viewer-is-user":e.viewerIsUser},null,8,["user","viewer","viewer-is-user"])])),_:1}),p(u,{xs:24},{default:f((()=>[p(m,{"user-listings":e.user.listings,limit:e.limit,"listings-page":e.listingsPage,"onUpdate:listingsPage":t[1]||(t[1]=t=>e.listingsPage=t)},null,8,["user-listings","limit","listings-page"]),e.user.bookings?(c(),d(h,{key:0,"user-bookings":e.user.bookings,limit:e.limit,"bookings-page":e.bookingsPage,"onUpdate:bookingsPage":t[2]||(t[2]=t=>e.bookingsPage=t)},null,8,["user-bookings","limit","bookings-page"])):_("",!0)])),_:1})])),_:1}))])),_:1})};export default ue;
